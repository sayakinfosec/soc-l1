## Wireshark Traffic Analysis

### Nmap Scans

Nmap is a widely used network scanning tool for host discovery and service enumeration. SOC analysts must recognize traffic patterns generated by common Nmap scan types to identify reconnaissance activity.

Common scan types:
- TCP Connect Scan (`-sT`)
- TCP SYN Scan (`-sS`)
- UDP Scan (`-sU`)

Useful Wireshark filters for scan identification:
- `tcp`, `udp`
- SYN only: `tcp.flags.syn == 1`
- ACK only: `tcp.flags.ack == 1`
- SYN+ACK: `tcp.flags == 18`
- RST: `tcp.flags.reset == 1`
- FIN: `tcp.flags.fin == 1`

TCP Connect Scan characteristics:
- Completes the TCP three-way handshake
- Used by non-privileged users
- Window size typically greater than 1024
- Open port: SYN → SYN/ACK → ACK
- Closed port: SYN → RST/ACK
- Detection filter:
  `tcp.flags.syn == 1 and tcp.flags.ack == 0 and tcp.window_size > 1024`

TCP SYN Scan characteristics:
- Half-open scan (handshake not completed)
- Used by privileged users
- Smaller window size (≤ 1024)
- Open port: SYN → SYN/ACK → RST
- Closed port: SYN → RST/ACK
- Detection filter:
  `tcp.flags.syn == 1 and tcp.flags.ack == 0 and tcp.window_size <= 1024`

UDP Scan characteristics:
- No handshake mechanism
- Open ports usually do not respond
- Closed ports return ICMP Destination Unreachable (Type 3, Code 3)
- ICMP packets encapsulate the original UDP request
- Detection filter:
  `icmp.type == 3 and icmp.code == 3`

Exercise findings (Exercise.pcapng):

Q. How many TCP Connect scans are present in the capture?

To identify TCP Connect scans, the following filter was used:
`tcp.flags.syn == 1 and tcp.flags.ack == 0 and tcp.window_size > 1024`

- `tcp.flags.syn == 1` indicates a new connection attempt
- `tcp.flags.ack == 0` confirms this is the first packet of the handshake (not a response)
- `tcp.window_size > 1024` suggests a full TCP connection expecting data, typical of TCP Connect scans

This filter isolates outbound scan attempts from the scanner.  
The result showed **1000 TCP Connect scans**.

Q. Which scan type was used to scan TCP port 80?

TCP port 80 traffic was reviewed within the TCP Connect scan results identified above.  
All scan attempts on port 80 followed a full TCP handshake pattern, confirming a **TCP Connect scan**.

Q. How many UDP closed-port messages are present?

UDP closed ports were identified using ICMP error responses:
`icmp.type == 3 and icmp.code == 3`

- ICMP Type 3 indicates Destination Unreachable
- ICMP Code 3 specifies Port Unreachable

This filter revealed **1083 ICMP responses**, indicating UDP closed-port scan results.

Q. Which UDP port is open in the 55–70 port range?

UDP traffic in the 55–70 port range was correlated with ICMP error responses.  
Port **68** generated UDP traffic **without corresponding ICMP Type 3 Code 3 responses**, indicating an open UDP service.


---


