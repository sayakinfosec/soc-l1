## Network Security Essentials 

### Introduction

Modern organizations rely on interconnected systems such as servers, workstations, applications, and security devices. These systems form a network ecosystem that must be protected from external threats. 

The network perimeter acts as the boundary between trusted internal systems and the untrusted Internet and is often the first target for attackers.

This room introduces fundamental network security concepts from a defensive perspective, focusing on understanding network structure, perimeter security, and monitoring logs for early attack detection.

**Learning Objectives**

* Understand what a network is and identify key components
* Learn the concept and importance of the network perimeter
* Identify common perimeter threats
* Analyze firewall and perimeter logs for suspicious activity

---

### A Network - Overview

Before securing a network, it is essential to understand its structure and components. A network is an organized collection of devices that communicate to share resources and access external services.

From a security perspective, knowing the role of each component helps identify abnormal behavior and potential attack paths.


### Network Components - Security Perspective

### 1. User Workstations (Endpoints)

Endpoints such as PCs and laptops are used by employees for daily tasks and are the most common initial attack vector.

**Security Relevance**

* Frequently targeted via phishing or malicious downloads
* Often less monitored than servers
* Can provide attackers a foothold for lateral movement

**Key Insight**
Network logs may reveal Command & Control (C2) traffic even before endpoint alerts trigger.


### 2. File & Database Servers

These servers store critical business data such as documents, customer records, and financial information.

**Security Relevance**

* High-value targets for attackers
* Common ransomware targets
* Often involved in data exfiltration campaigns


### 3. Application Servers (Web, Email, VPN)

These servers provide externally accessible services.

**Security Relevance**

* Constantly scanned for vulnerabilities
* Successful exploitation can lead to internal access

**Monitored Indicators**

* Web exploitation attempts (SQLi, XSS)
* Brute-force login attempts
* Suspicious external IP interactions


### 4. Active Directory (Authentication Servers)

Active Directory manages identities, access control, and authentication.

**Security Relevance**

* Central authority for enterprise access
* Primary target for privilege escalation
* Compromise can lead to full domain takeover

**Monitored Indicators**

* Password spraying
* Unusual login locations or times
* Unauthorized resource access


### 5. Routers & Switches

These devices enable network communication and traffic routing.

**Security Relevance**

* Traffic interception (MITM)
* Hidden backdoors via routing manipulation
* Stealthy persistence mechanisms


### 6. Firewalls / Perimeter Devices

Firewalls control traffic between internal and external networks and generate critical logs.

**Security Relevance**

* First line of defense
* Early indicators of scanning, brute-force, and exploitation attempts
* Key log source for SOC analysts

---

### Network Visibility

Network visibility is the ability to observe and understand network activity. Effective security monitoring depends on visibility; without it, threats can go undetected.

Visibility is achieved primarily through logs, which allow analysts to reconstruct attack timelines and detect anomalies.


### 1. Host-Centric Logs

Logs generated by individual systems such as workstations and servers.

**Key Host-Centric Log Sources**

* OS logs (Windows Event Logs, Linux syslog)
* Application logs (Web servers, databases)
* Endpoint security tools (EDR, antivirus)

**Security Value**

* Process execution tracking
* User activity monitoring
* Malware impact analysis
* Detailed forensic investigation


### 2. Network-Centric Logs

Logs generated by network devices that observe traffic flow.

**What They Show**

* Source and destination IPs
* Ports and protocols
* Allow or block actions

**Key Network-Centric Log Sources**

* Firewalls
* IDS/IPS
* Routers (NetFlow)
* Web proxies
* VPN gateways

**Security Value**

* Early threat detection
* C2 communication identification
* Lateral movement tracking
* Data exfiltration detection

---

### Network Perimeter

The network perimeter separates trusted internal systems from the untrusted Internet. All inbound and outbound traffic passes through this boundary.

**Key Components**

* Firewalls
* Routers / Gateways
* DMZ
* VPN gateways

The perimeter is often where attackers are first detected.


### Importance of the Network Perimeter

A misconfigured or weak perimeter can lead to:

* Unauthorized access (RDP, SSH exposure)
* Data breaches
* Malware infiltration

Attackers commonly perform scanning, brute-forcing, and exploitation attempts against perimeter services.


### Role of a Security Analyst

Monitoring the perimeter involves:

* Reviewing firewall logs
* Detecting scans and brute-force patterns
* Identifying suspicious outbound traffic
* Understanding exposed services

---

### Network Perimeters - Monitoring and Protecting

Perimeter monitoring uses firewalls, IDS/IPS, and access controls to detect and prevent attacks.

**Analyst Objectives**

* Identify reconnaissance activity
* Detect misconfigurations
* Spot malware beaconing or exfiltration


### Scenario 1 - Port Scanning

An attacker probes multiple ports on a single internal host.

**Indicators**

* Repeated connection attempts
* Same source IP
* Multiple destination ports

**Verdict**
Classic port scanning activity detected via firewall logs.


### Scenario 2 - Web Application Attacks

A WAF identifies and blocks malicious HTTP requests.

**Detected Attacks**

* XSS
* Directory traversal
* SQL injection

**Verdict**
High-confidence attack targeting the web application, successfully blocked.


### Scenario 3 - VPN Brute-Force Attack

An attacker attempts repeated authentication failures against a VPN gateway.

**Indicators**

* High volume of FAILED_AUTH events
* Common username usage
* Single source IP

**Verdict**
Confirmed brute-force attack against VPN authentication.


### Key Takeaways

* Security analysis is pattern-based, not event-based
* One source → many ports = scanning
* One source → one service = brute-force
* Regular outbound intervals = potential malware beaconing
* IDS context adds significant investigative value
* Perimeter monitoring enables early attack detection

---

### Perimeter Logs – Investigating the Breach

**Incident Scenario**  
Initech Corp, a mid-sized financial services company, deployed a new firewall and IDS to monitor its network perimeter. Over a one-month period, abnormal traffic patterns were observed but not deeply investigated due to SOC workload. The task was to analyze one month of perimeter logs to identify adversary techniques and determine whether the perimeter was breached.

The analysis was performed using firewall logs, IDS alerts, and VPN authentication logs, with reference to known internal network assets.

**Log Sources Reviewed**
- Firewall Logs (`firewall.log`)
- IDS / WAF Logs (`ids_alerts.log`)
- VPN Authentication Logs (`vpn_auth.log`)

**Reconnaissance Activity**  
Analysis of blocked firewall traffic showed an external IP probing multiple internal hosts across several ports, including SSH (22), Telnet (23), FTP (21), SMB (445), and RDP (3389). This behavior is consistent with active reconnaissance and port scanning.

Further aggregation of blocked events revealed one external IP responsible for the highest number of blocked connection attempts, confirming focused reconnaissance activity.

**Question:** What external IP performed the most reconnaissance?  
**Answer:** 203.0.113.45

**Question:** Which internal host was primarily targeted by scans?  
**Answer:** 10.0.0.20

**Initial Access – VPN Credential Abuse**  
VPN authentication logs revealed a high number of failed login attempts against a specific service account, followed by successful authentication events. This indicates brute-force or credential stuffing activity resulting in valid credential compromise.

After successful authentication, the attacker was assigned an internal VPN IP address, confirming perimeter breach and internal access.

**Question:** Which username was targeted in the VPN logs?  
**Answer:** svc_backup

**Question:** What internal IP was assigned after successful VPN login?  
**Answer:** 10.8.0.23

**Lateral Movement**  
Post-compromise firewall logs showed the assigned internal IP initiating connections to multiple internal systems. These connections targeted critical services including SSH (22), SMB (445), and RDP (3389).

IDS alerts correlated with this activity flagged SSH scans, SMB exploitation attempts, and RDP brute-force attempts, confirming active lateral movement within the internal network.

**Question:** Which port was used for lateral SMB attempts?  
**Answer:** 445

**Command and Control (C2) Beaconing**  
IDS logs contained repeated alerts indicating possible C2 beaconing behavior. These alerts showed regular outbound connections from a compromised internal host to an external IP over a non-standard port, a strong indicator of malware persistence and remote control.

**Question:** In the IDS logs, which host was beaconing to the C2 server?  
**Answer:** 10.0.0.60

**Question:** Which external IP was associated with C2 activity?  
**Answer:** 198.51.100.77

**Data Exfiltration Attempts**  
Firewall logs showed large volumes of outbound traffic from a compromised internal host to external destinations over HTTP and alternate web ports. Corresponding IDS alerts flagged these events as large HTTP POST uploads, indicating potential data exfiltration.

**Question:** Which host showed evidence of data exfiltration attempts?  
**Answer:** 10.0.0.51

---

### Conclusion

In this room, we learned that an enterprise network is not just a collection of computers and servers, but an interconnected ecosystem consisting of firewalls, authentication systems, application servers, file and database servers, and endpoints.

The network perimeter represents the boundary between trusted and untrusted networks and is continuously tested by attackers through scanning, brute-force attempts, and service exploitation.

From a SOC analyst perspective, effective perimeter monitoring enables:
- Early detection of reconnaissance and credential abuse
- Identification of lateral movement and internal exploitation
- Detection of C2 communication and data exfiltration attempts

The role of a security analyst is to recognize suspicious patterns, correlate events across multiple log sources, and escalate confirmed threats before attackers can cause significant damage to the organization.



